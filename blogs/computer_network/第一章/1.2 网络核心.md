# 网络核心

### 为什么需要数据交换？

如果要实现主机与主机之间的数据交换，两两相连肯定不现实（成本高，技术难度大），因此在几个主机间用一个<font color="red">交换设备</font>进行连接，这样就可以实现主机互联。

但是这样做也存在一些局限性：

>1. 主机距离交换设备太远以至于连接不上。
>2. 如果需要交换的主机数太多，交换设备的端口也需要很多。

为了解决这个问题，可以把交换设备<font color='red'>组成网络</font>。这样做，既减少了每台交换机的负担，也避免只有一台交换机出现距离问题。

![image-20211126144359750](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126144359750.png)

### 数据交换的类型

#### 1.电路交换

![image-20211126144701699](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126144701699.png)

最大的特点就是：<font color='red'>独占资源</font>

但是，我们可以思考一下：日常生活中，同一时刻会有非常多的人打电话。基本上肯定会有**共享的**线路，如果贡献线路是**独占**的，那么打电话就是一个很大的问题了。

因此我们需要一种技术来实现<font color='red'>电路交换网络的链路共享</font>：这就是**多路复用技术**

![image-20211126145248186](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126145248186.png)

##### 多路复用

由于信道的运输能力足够，可以实现**多路复用共享信道**

![image-20211126145435014](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126145435014.png)

1. 频分多路复用（FMD）

![image-20211126145811029](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126145811029.png)

四个用户使用四种频率，不同用户互不干扰。

2. 时分多路复用（TDM）

可以和频分做对比，不同的用户在**不同的TDM帧的固定时隙**传输数据

![image-20211126150031070](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126150031070.png)

3. 波分多路复用（WDM）

WDM实际上是FDM（针对光波波长分割）

![image-20211126150204562](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126150204562.png)

4. 码分多路复用（CDM）

![image-20211126151548671](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126151548671.png)

在码分复用中，每个用户都有一个**唯一**的码片序列（chipping sequence），各个用户把自己要发的数据**乘上**码片序列，可以得到编码后的数据，每个用户都将这样算出来的结果放到信道中。这样肯定会叠加起来导致传输的信息和发送的信息不一致。

为了让接收时，可以得到发送时的序列，<font color="red">用户的码片序列相互正交</font>

由于正交，将信道的信息和发送信息的用户码片相乘，其他用户的码片对发送信息的用户码片不构成影响（正交，相乘=0），因此可以得到这样的结果。

![image-20211126151650989](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126151650989.png)

#### 2.报文交换（message switching）

![image-20211126151943222](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126151943222.png)

特点：必须**以整体**传递信息

#### 3.分组交换

分组交换在报文交换的基础上，把报文**拆成一个一个的小数据包**。

因此分组交换需要**拆分**和**重组**，这样会带来额外的开销

分组交换有一些特点：

>1. 可以流水线操作（由于可以切片，就可以用流水线）
>2. 复用使用**统计多路复用技术**

![image-20211126152730715](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126152730715.png)

A和B都向**路由器**发送数据，但是在数据链路只有一条，A和B的数据包被分散在这条链路中。

<font color="red">如果A发送的数据多，那么A就更有可能在链路中被选中，那么A所占的带宽就会高，反之亦然。</font>

#### 存储—转发

![image-20211126153116166](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126153116166.png)

### 分组交换和报文交换区别

首先引入时延（延迟）这个概念：

>延迟 = 传输的字节数（分组长度） bits / 传输速率(bits/sec)

换句话说，延迟就是传输数据所需要的时间。如果时间越少，就说明延迟越低。

![image-20211126165940060](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126165940060.png)

#### 报文交换：

在报文交换中，路由器需要7.5M的缓存，因为路由器需要把整个报文全部接收。

![image-20211126170010077](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126170010077.png)

#### 分组交换：

在分组交换中，路由器只需要1.5K缓存就能完成。

![image-20211126170410554](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126170410554.png)

#### 时间对比：

![image-20220118121737990](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20220118121737990.png)

#### 小例题：

![image-20211126172305592](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126172305592.png)

#### 解答：

![image-20211126172335248](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126172335248.png)

### 分组交换和电路交换区别

![image-20211126174127133](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126174127133.png)

**平均活动时间指的是**：用户在使用网络时，真正传输数据的时间（看网页没有传输数据，下载，上传还有点击别的页面才使用了数据传输功能）

对于电路交换而言，由于资源是独占的。1M的带宽，如果每个用户需要100kb/s，就只能允许10个用户使用。

<font color="red">即使用户没有使用数据传输，线路也会被占用</font>

但是对于分组交换而言，由于线路是组合多路复用，可以允许很多用户同时使用。

#### 那么分组交换绝对优于电路网络吗？

答案是不一定：不同的网络各有特点

![image-20211126175029529](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211126175029529.png)