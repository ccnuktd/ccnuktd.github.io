# 1.4 计算机网络体系结构

### 计算机网络体系结构的描述

![image-20211128100557144](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128100557144.png)

### 分层网络体系结构基本概念

![image-20211128101158263](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128101158263.png)

### OSI（Open System Interconnection）参考模型

![image-20211128101541621](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128101541621.png)

![image-20211128190054075](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128190054075.png)

在OSI参考模型中，进行数据的传输需要经过7层的数据封装，这种封装通过**添加头部或尾部控制信息**来实现控制，目的主机接收后，也需要7层的解码，最后才能得到数据。如下图所示：

![image-20211128190402705](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128190402705.png)

#### 为什么需要数据封装？

![image-20211128190806999](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128190806999.png)

### OSI参考模型详解

#### 物理层

![image-20211128191255956](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128191255956.png)

#### 数据链路层

![image-20211128192552298](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128192552298.png)

简要解释：

> 这里的结点指的是**通过线直接连接的两个物理结点**
>
> 组帧：由于物理传输只传输bit，但是并没有说明bit的含义，在数据链路层的头尾控制信息中，就说明了关于帧的信息。
>
> 物理寻址：（注意是在**数据链路层**，而不是在**物理层**）即在帧头写入发送端和/或接收端的地址。

这里有一个问题，为什么需要物理寻址，发送端和接收端是直接用线连接的，就意为着已经知道彼此身份，但是为什么仍然需要地址确认？
答：如果出现**一个发送端**，与**若干个接收端**连接。发送端发送的信息，所有的接收端都可以接收到，但是这个信息可能只针对一个人，因此这个时候就需要确认身份了。这种情况叫做——广播。

![image-20211128193118023](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128193118023.png)

除此之外还有一些功能

![image-20211128193251058](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128193251058.png)

#### 网络层

![image-20211128193532771](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128193532771.png)

在网络层中，由于发送的包可能会跨越很多路由器，这个时候物理地址就失效了。因此需要一个在网络中能够唯一标识某个端的地址，这就是**逻辑地址**，比如IP地址。

![image-20211128193901248](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128193901248.png)

网络层还需要实现路由和分组转发的功能。在分组转发过程中，源和目的地址（**IP地址**）没有变，但是由于多次路由，所以需要多次改变**物理地址**。

#### 传输层（端到端）

![image-20211128194456380](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128194456380.png)

传输层需要进行报文的**分组**，和接收后的**重组**。

传输层要实现进程之间的传输，因此需要考虑不同进程的进程号（端口号），所以传输层有一个端口地址（SAP寻址）

![image-20211128195128910](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128195128910.png)

#### 会话层

![image-20211128195424083](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128195424083.png)

在当前的Internet中没有这一层

#### 表示层

![image-20211128195538423](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128195538423.png)

由于不同主机之间数据的表示不太一样，（比如说：大端小端）所以需要表示层处理信息的**语法**和**语义**的问题。

在Internet中这一层也不存在，在应用层中完成了这个功能。

#### 应用层

![image-20211128195934883](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128195934883.png)

除了OSI参考模型，还有**TCP/IP**参考模型

![image-20211128200114480](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128200114480.png)

TCP/IP参考模型的特点：只需要有一个IP地址，就可以为各种应用提供服务。对网络接口层也没有限制，只要可以封装成IP分组就可以，不管用什么方法。

把TCP/IP模型和OSI参考模型结合一下，就有综合成了5层参考模型

![image-20211128200559695](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128200559695.png)

##### 5层模型的数据封装

![image-20211128201744501](https://gitee.com/ccnuktd/pic-bed/raw/master/image-20211128201744501.png)

>在源主机的应用层，有一个信息需要传递到目的主机中，下面是传递的过程。
>
>1. 源主机**应用层**->**传输层**，加上段信息（Segment）
>2. 源主机**传输层**->**网络层**，加上网络层的数据（datagram）
>3. 源主机**网络层**->**链路层**，加头加尾，构造帧
>4. 源主机**链路层**->**物理层**，物理层传输到交换机的物理层
>5. 交换机**物理层**->**链路层**，链路层传输到路由器的物理层
>6. 路由器**物理层**->**链路层**，还原信息
>7. 路由器**链路层**->**网络层**，还原信息
>8. 路由器**网络层**->**链路层**，加头加尾，构造帧
>9. 路由器机**链路层**->**物理层**，物理层传输到目的的物理层
>10. 目的主机**物理层**->**链路层**，还原信息
>11. 目的主机**链路层**->**网络层**，还原信息
>12. 目的主机**网络层**->**传输层**，还原信息
>13. 目的主机**传输层**->**应用层**，还原信息

简单说一下交换机和路由器的异同点

> ***路由谋短，交换求快。***
>
> ***交换机工作于数据链路层，用来隔离冲突域，连接的所有设备同属于一个广播域（子网），负责子网内部通信。***
>
> ***路由器工作于网络层，用来隔离广播域（子网），连接的设备分属不同子网，工作范围是多个子网之间，负责网络与网络之间通信。***
>
> 
>
> **工作层次不同：**
> 交换机主要工作在数据链路层（第二层）
> 路由器工作在网络层（第三层）。
> **转发依据不同：**
> 交换机转发所依据的对象时：MAC地址。（物理地址）
> 路由转发所依据的对象是：IP地址。（网络地址）
> **主要功能不同：**
> 交换机主要用于组建局域网，
> 而路由主要功能是将由交换机组好的局域网相互连接起来，或者接入Internet。
> 交换机能做的，路由都能做。
> 交换机不能分割广播域，路由可以。
> 路由还可以提供防火墙的功能。
> 路由配置比交换机复杂。
> **价格不同**
>
> 交换机是看门大爷，路由是邮差。