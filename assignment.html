<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./assignment.css">
    <title>Document</title>
</head>
<body> 
    <div class="grid-container">
        <div class="nav">
            <h1>ccnuktd的小站</h1>
            <div class='ribbon'>
                <a href="./index.html"><span>主页</span></a>
                <a href="./assignment.html"><span>课表（作业2）</span></a>
                <a href=""><span>兴趣</span></a>
                <a href="./html/index.html"><span>音乐区</span></a>
            </div>
        </div>
    </div>
    <div class="grid-table">   
        <main>我的课表</main>
        <table>
            <tr>
                <th></th>
                <th scope="col">一</th>
                <th scope="col">二</th>
                <th scope="col">三</th>
                <th scope="col">四</th>
                <th scope="col">五</th>
                <th scope="col">六</th>
                <th scope="col">日</th>
            </tr>
            <tr class="course1">
                <th scope="row">1</th>
                
            </tr>
            <tr class="course2">
                <th scope="row">2</th>
            </tr>
            <tr class="course3">
                <th scope="row">3</th>
                
            </tr>
            <tr class="course4">
                <th scope="row">4</th>
            </tr>
            <tr class="course5">
                <th scope="row">5</th>
                
            </tr>
            <tr class="course6">
                <th scope="row">6</th>
            </tr>
            <tr class="course7">
                <th scope="row">7</th>
                
            </tr>
            <tr class="course8">
                <th scope="row">8</th>
            </tr>
            <tr class="course9">
                <th scope="row">9</th>
                
            </tr>
            <tr class="course10">
                <th scope="row">10</th>
            </tr>
            <tr class="course11">
                <th scope="row">11</th>
                
            </tr>
            <tr class="course12">
                <th scope="row">12</th>
            </tr>
        </table>
        <div>
            <p>简介</p>
            <div id="view">
                
            </div>  
        </div>
    </div>
</body> 
<script type="text/javascript">
    
    var xhr = new XMLHttpRequest();
    var list = [];
    xhr.open("get","https://ccnuktd.github.io/test.json"); //url改成自己的请求地址
    xhr.send(null);
    xhr.onreadystatechange = function() {
        if(xhr.readyState == 4 && xhr.status == 200) {
            list = JSON.parse(xhr.responseText);
            list = list[key];
            console.log(list);
        }
    }
    
    var list2 = [
        {
            "课程名称": "windows程序设计",
            "课程安排": "1~19周",
            "上课时间": 1,
            "任课教师": "李源",
            "上课地点": "N113",
            "上课节数": [1,2]
        },
        {
            "课程名称": "微机原理与接口技术",
            "课程安排": "1~19周",
            "上课时间": 1,
            "任课教师": "陈怡",
            "上课地点": "N211",
            "上课节数": [3,4]
        },
        {
            "课程名称": "web程序设计",
            "课程安排": "1~18周单",
            "上课时间": 2,
            "任课教师": "涂星辉",
            "上课地点": "N108",
            "上课节数": [1,2]
        },
        {
            "课程名称": "专业英语",
            "课程安排": "1~19周",
            "上课时间": 1,
            "任课教师": "李增扬",
            "上课地点": "N112",
            "上课节数": [7,8]
        },
        {
            "课程名称": "苍穹的奥秘",
            "课程安排": "1~10周",
            "上课时间": 1,
            "任课教师": "郑小平",
            "上课地点": "9532",
            "上课节数": [9,10,11,12]
        },
        {
            "课程名称": "人工智能",
            "课程安排": "1~19周",
            "上课时间": 3,
            "任课教师": "张连发",
            "上课地点": "n520",
            "上课节数": [1,2]
        },
        {
            "课程名称": "操作系统原理",
            "课程安排": "1~19周",
            "上课时间": 3,
            "任课教师": "叶俊民",
            "上课地点": "N108",
            "上课节数": [3,4]
        },
        {
            "课程名称": "windows程序设计",
            "课程安排": "1~18周双",
            "上课时间": 3,
            "任课教师": "李源",
            "上课地点": "N113",
            "上课节数": [7,8]
        },
        {
            "课程名称": "习近平新时代中国特色社会主义思想概论",
            "课程安排": "1~19周",
            "上课时间": 4,
            "任课教师": "吕惠东",
            "上课地点": "N223",
            "上课节数": [3,4]
        },
        {
            "课程名称": "web程序设计",
            "课程安排": "1~19周",
            "上课时间": 4,
            "任课教师": "涂星辉",
            "上课地点": "N108",
            "上课节数": [5,6]
        },
        {
            "课程名称": "编译原理",
            "课程安排": "1~19周",
            "上课时间": 4,
            "任课教师": "杨青",
            "上课地点": "N108",
            "上课节数": [7,8]
        },
        {
            "课程名称": "操作系统原理",
            "课程安排": "1~19周",
            "上课时间": 5,
            "任课教师": "叶俊民",
            "上课地点": "N108",
            "上课节数": [1,2]
        },
        {
            "课程名称": "青年与二次元（通核）",
            "课程安排": "1~21周",
            "上课时间": 5,
            "任课教师": "李三强",
            "上课地点": "8212",
            "上课节数": [3,4]
        }
    ];
    //通过list生成文档对象
    //12表示一天12节课
    // console.log(list2);
    // console.log(list[0]);
    // console.log(list[0]);
    // console.log(list2[0]["上课节数"]);
    // console.log(list2[0]["上课时间"]);
    for(var course = 1;course <= 12;course ++){
        //5表示一周5天有课
        for(var time = 1;time <= 7;time ++){
            var flag = 0;
            for(var i = 0;i < list.length;i ++){
                
                if(list[i]["上课节数"].includes(course) && list[i]["上课时间"] === Number(time)){
                    console.log("sdf");
                    var para = document.createElement("th");
                    var text = document.createTextNode(list[i]["课程名称"]);
                    para.id = "course" + course + "time" + time;
                    var value1 = "getInfo('" + list[i]["课程名称"].toString() + "','" + para.id + "')";
                    para.setAttribute("onmouseover",value1);
                    var value2 = "hiddenInfo('" + list[i]["课程名称"].toString() + "','" + para.id + "')";
                    para.setAttribute("onmouseout",value2);
                    console.log(para);
                    para.appendChild(text);
                    var element = document.querySelector(".course" + course);
                    element.appendChild(para);
                    flag = 1;
                    break;
                }
            }
            if(flag == 0){
                var para = document.createElement("th");
                var text = document.createTextNode("");
                para.appendChild(text);
                var element = document.querySelector(".course" + course);
                // console.log(element);
                element.appendChild(para);
            }
        }
    }

    function getInfo(name,id){
        var par = document.querySelector("#view");
        for(var i = 0;i < list.length;i ++){
            if(list[i]["课程名称"] === name){
                let course,time;
                // console.log(id);
                //利用正则表达式匹配
                var idArr = id.match(/\d+/g);
                course = Number(idArr[0]);
                time = Number(idArr[1]);
                // console.log(course);
                // console.log(time);
                if(list[i]["上课时间"] === time && list[i]["上课节数"].includes(course)){
                    const para1 = document.createElement("p");
                    var text1 = document.createTextNode("课程安排：" + list[i]["课程安排"]);
                    para1.appendChild(text1);
                    // console.log(par);
                    par.appendChild(para1);
                    const para2 = document.createElement("p");
                    para2.innerHTML = "上课时间：周" + list[i]["上课时间"];
                    par.appendChild(para2);
                    // console.log(para2);
                    let para3 = document.createElement("p");
                    para3.innerHTML = "任课教师：" + list[i]["任课教师"];
                    par.appendChild(para3);
                    let para4 = document.createElement("p");
                    para4.innerHTML = "上课地点：" + list[i]["上课地点"];
                    par.appendChild(para4);
                }
                
            }
        }
    }
    function hiddenInfo(name,id){
        var par = document.getElementById("view");
        par.innerHTML = "";
    }
</script>
</html>